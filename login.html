<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Login - BugBoard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="login-page">

<div class="login-card">
  <span class="login-logo">ðŸš€</span>
  <h2 style="color: #2c3e50; margin-bottom: 5px;">Benvenuto</h2>
  <p style="color: #7f8c8d; margin-bottom: 30px;">Accedi per gestire i tuoi ticket</p>

  <form id="loginForm" novalidate>
    <div class="form-group" style="text-align: left">
      <label>Email</label>
      <input type="email" id="email" placeholder="nome@esempio.com" required>
    </div>

    <div class="form-group" style="text-align: left">
      <label>Password</label>
      <input type="password" id="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
    </div>

    <button type="submit" class="submit-btn" style="margin-top: 10px;">Entra nella Dashboard</button>
  </form>

  <p style="margin-top: 15px; font-size: 0.9em; color: #666;">
    Non hai un account? <a href="register.html" style="color: #3498db;">Registrati ora</a>
  </p>

  <small style="display: block; margin-top: 30px; color: #aaa; border-top: 1px solid #eee; padding-top: 20px;">
    BugBoard v1.0
  </small>
</div>

<div id="notification" class="notification hidden" style="position: fixed; bottom: 20px; right: 20px; z-index: 9999;"></div>

<script>
  document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const email = document.getElementById('email').value;
      const password = "password";

      try {
          const response = await fetch('http://localhost:8080/api/users/login', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ email: email, password: password })
          });

          if (response.ok) {
              const user = await response.json();
              localStorage.setItem('user', JSON.stringify(user));

              showNotification("âœ… Accesso riuscito! Entro...", "success");

              setTimeout(() => {
                  window.location.href = 'index.html';
              }, 1500);

          } else {
              showNotification("âŒ Utente non trovato!", "error");
          }
      } catch (error) {
          console.error("Errore:", error);
          showNotification("âš ï¸ Server non raggiungibile.", "error");
      }
  });

  function showNotification(message, type) {
      const notification = document.getElementById('notification');

      // 1. Inseriamo il testo ORA, non nell'HTML
      notification.textContent = message;

      // 2. Colore
      if (type === 'error') {
          notification.style.backgroundColor = '#e74c3c'; // Rosso
          notification.style.color = 'white';
      } else {
          notification.style.backgroundColor = '#2ecc71'; // Verde
          notification.style.color = 'white';
      }

      // 3. Stile base per renderla carina (padding, arrotondamento)
      notification.style.padding = "15px 25px";
      notification.style.borderRadius = "8px";
      notification.style.boxShadow = "0 4px 12px rgba(0,0,0,0.2)";

      // 4. Mostra
      notification.classList.remove('hidden');

      // 5. Nascondi dopo 3 secondi
      setTimeout(() => {
          notification.classList.add('hidden');
      }, 3000);
  }
</script>
</body>
</html>